webpackJsonp([27],{739:function(n,l,t){"use strict";function e(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,8,"ion-item",[["class","item item-block"]],null,null,null,L.b,L.a)),o["ɵdid"](1,1097728,null,3,E.a,[O.a,T.a,o.ElementRef,o.Renderer,[2,F.a]],null,null),o["ɵqud"](335544320,1,{contentLabel:0}),o["ɵqud"](603979776,2,{_buttons:1}),o["ɵqud"](603979776,3,{_icons:1}),o["ɵdid"](5,16384,null,0,C.a,[],null,null),(n()(),o["ɵted"](-1,2,["\n            "])),(n()(),o["ɵeld"](7,0,null,2,0,"img",[["alt","logo"],["crossOrigin","anonymous"],["style","display: block;\n                        margin: 25px auto;\n                        width: 200px;\n                        height: 200px;"]],[[8,"src",4]],null,null,null,null)),(n()(),o["ɵted"](-1,2,["\n        "]))],null,function(n,l){n(l,7,0,l.context.$implicit)})}function a(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,8,"ion-item",[["class","item item-block"]],null,null,null,L.b,L.a)),o["ɵdid"](1,1097728,null,3,E.a,[O.a,T.a,o.ElementRef,o.Renderer,[2,F.a]],null,null),o["ɵqud"](335544320,4,{contentLabel:0}),o["ɵqud"](603979776,5,{_buttons:1}),o["ɵqud"](603979776,6,{_icons:1}),o["ɵdid"](5,16384,null,0,C.a,[],null,null),(n()(),o["ɵted"](-1,2,["\n            "])),(n()(),o["ɵeld"](7,0,null,2,0,"img",[["alt","logo"],["crossOrigin","anonymous"],["style","display: block;\n                        margin: 25px auto;\n                        width: 200px;\n                        height: 200px;"]],[[8,"src",4]],null,null,null,null)),(n()(),o["ɵted"](-1,2,["\n        "]))],null,function(n,l){n(l,7,0,l.context.$implicit)})}function i(n){return o["ɵvid"](0,[(n()(),o["ɵted"](-1,null,["\n"])),(n()(),o["ɵeld"](1,0,null,null,10,"ion-header",[],null,null,null,null,null)),o["ɵdid"](2,16384,null,0,U.a,[T.a,o.ElementRef,o.Renderer,[2,x.a]],null,null),(n()(),o["ɵted"](-1,null,["\n    "])),(n()(),o["ɵeld"](4,0,null,null,6,"ion-navbar",[["class","toolbar"],["color","primary"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,N.b,N.a)),o["ɵdid"](5,49152,null,0,_.a,[M.a,[2,x.a],[2,D.a],T.a,o.ElementRef,o.Renderer],{color:[0,"color"]},null),(n()(),o["ɵted"](-1,3,["\n        "])),(n()(),o["ɵeld"](7,0,null,3,2,"ion-title",[],null,null,null,S.b,S.a)),o["ɵdid"](8,49152,null,0,B.a,[T.a,o.ElementRef,o.Renderer,[2,J.a],[2,_.a]],null,null),(n()(),o["ɵted"](-1,0,["imagePick"])),(n()(),o["ɵted"](-1,3,["\n    "])),(n()(),o["ɵted"](-1,null,["\n"])),(n()(),o["ɵted"](-1,null,["\n\n"])),(n()(),o["ɵeld"](13,0,null,null,26,"ion-content",[["no-bounce",""],["padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,q.b,q.a)),o["ɵdid"](14,4374528,null,0,V.a,[T.a,W.a,j.a,o.ElementRef,o.Renderer,M.a,G.a,o.NgZone,[2,x.a],[2,D.a]],null,null),(n()(),o["ɵted"](-1,1,["\n    "])),(n()(),o["ɵeld"](16,0,null,1,2,"button",[["full",""],["ion-button",""]],null,[[null,"click"]],function(n,l,t){var e=!0;if("click"===l){e=!1!==n.component.onClickForUploadImgBtn()&&e}return e},Q.b,Q.a)),o["ɵdid"](17,1097728,null,0,$.a,[[8,""],T.a,o.ElementRef,o.Renderer],{full:[0,"full"]},null),(n()(),o["ɵted"](-1,0,["\n        上传照片\n    "])),(n()(),o["ɵted"](-1,1,["\n\n    "])),(n()(),o["ɵeld"](20,0,null,1,1,"label",[],null,null,null,null,null)),(n()(),o["ɵted"](-1,null,["base64Image："])),(n()(),o["ɵted"](-1,1,["\n    "])),(n()(),o["ɵeld"](23,0,null,1,5,"ion-list",[],null,null,null,null,null)),o["ɵdid"](24,16384,null,0,H.a,[T.a,o.ElementRef,o.Renderer,W.a,K.m,j.a],null,null),(n()(),o["ɵted"](-1,null,["\n        "])),(n()(),o["ɵand"](16777216,null,null,1,null,e)),o["ɵdid"](27,802816,null,0,Z.i,[o.ViewContainerRef,o.TemplateRef,o.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),o["ɵted"](-1,null,["\n    "])),(n()(),o["ɵted"](-1,1,["\n    "])),(n()(),o["ɵeld"](30,0,null,1,1,"label",[],null,null,null,null,null)),(n()(),o["ɵted"](-1,null,["fileUrlImage："])),(n()(),o["ɵted"](-1,1,["\n    "])),(n()(),o["ɵeld"](33,0,null,1,5,"ion-list",[],null,null,null,null,null)),o["ɵdid"](34,16384,null,0,H.a,[T.a,o.ElementRef,o.Renderer,W.a,K.m,j.a],null,null),(n()(),o["ɵted"](-1,null,["\n        "])),(n()(),o["ɵand"](16777216,null,null,1,null,a)),o["ɵdid"](37,802816,null,0,Z.i,[o.ViewContainerRef,o.TemplateRef,o.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),o["ɵted"](-1,null,["\n    "])),(n()(),o["ɵted"](-1,1,["\n\n"])),(n()(),o["ɵted"](-1,null,["\n"]))],function(n,l){var t=l.component;n(l,5,0,"primary");n(l,17,0,"");n(l,27,0,t.base64Image);n(l,37,0,t.fileUrlImage)},function(n,l){n(l,4,0,o["ɵnov"](l,5)._hidden,o["ɵnov"](l,5)._sbPadding);n(l,13,0,o["ɵnov"](l,14).statusbarPadding,o["ɵnov"](l,14)._hasRefresher)})}Object.defineProperty(l,"__esModule",{value:!0});var o=t(1),u=t(0),r=(t(19),t(217)),s=t(240),d=t(68),c=t(32),g=t(125),m=t(45),f=t(54),h=function(n){function l(l,t,e,a,i,o,u,r,s){var d=n.call(this,l,t,e,a,i)||this;return d.navCtrl=l,d.navParams=t,d.platform=e,d.utils=a,d.httpUtils=i,d.imagePicker=o,d.camera=u,d.fileManager=r,d.actionSheetCtrl=s,d.tag="ImagePickPage",d.base64Image=[],d.fileUrlImage=[],d}return Object(u.__extends)(l,n),l.prototype.ionViewDidLoad=function(){},l.prototype.ionViewDidEnter=function(){var n=this;this.fileManager.resolveDirectoryUrl(this.fileManager.file.externalCacheDirectory).then(function(l){l.createReader().readEntries(function(l){if(l.length){m.a.log("读取到"+l.length+"个文件");for(var t=0;t<l.length;t++)m.a.log(l[t].name,n.tag),n.fileUrlImage.push(l[t].toURL()),n.getImageToBase64(l[t].toURL())}else m.a.log("没有文件！",n.tag)},function(n){m.a.error(n)})}).catch(function(n){m.a.error(n)})},l.prototype.ionViewDidLeave=function(){this.camera.cleanup().then(function(n){m.a.log("清理选择图片产生的缓存成功！Info："+JSON.stringify(n))},function(n){m.a.log("清理选择图片产生的缓存失败！Info："+JSON.stringify(n))})},l.prototype.onClickForUploadImgBtn=function(){var n=this;this.actionSheetCtrl.create({title:"选择图片来源",buttons:[{text:"拍照",handler:function(){n.takePhoto()}},{text:"从相册选择",handler:function(){n.pickImage()}},{text:"取消",role:"cancel"}]}).present()},l.prototype.takePhoto=function(){var n=this;this.camera.getPicture({quality:50,destinationType:this.camera.DestinationType.FILE_URI,sourceType:this.camera.PictureSourceType.CAMERA,encodingType:this.camera.EncodingType.JPEG,allowEdit:!0,mediaType:this.camera.MediaType.PICTURE,targetWidth:800,targetHeight:800,correctOrientation:!0,saveToPhotoAlbum:!1,cameraDirection:this.camera.Direction.BACK}).then(function(l){n.fileUrlImage.push(l.toString()),n.getImageToBase64(l),alert(l),n.utils.showLoading("上传中...0%"),n.httpUtils.uploadImageWithPligin(f.a.API+f.a.API_UPLOAD_FILE,l,function(l){n.utils.dismissLoading(),n.utils.showNativeToast("图片上传成功! ","long","bottom"),m.a.log("图片上传成功----\x3e"+JSON.stringify(l),n.tag)},function(l){n.utils.dismissLoading(),n.utils.showNativeToast("图片上传失败! ","long","bottom"),m.a.error("图片上传失败----\x3e"+JSON.stringify(l),n.tag)},function(l){n.utils.setLoadingContent("上传中..."+(l.loaded/l.total*100).toFixed(2)+"%")})},function(n){})},l.prototype.pickImage=function(){var n=this;this.platform.is("android")?this.imagePicker.hasReadPermission().then(function(l){l?n.pickImageFormPhotoLibrary():n.imagePicker.requestReadPermission().then(function(n){}).catch(function(l){return n.utils.showToastMsg("请求读图片权限失败，请在设置中手动设置！Error："+JSON.stringify(l))})}).catch(function(l){n.utils.showToastMsg("检查是否有读图片权限失败！Error："+JSON.stringify(l))}):this.pickImageFormPhotoLibrary()},l.prototype.pickImageFormPhotoLibrary=function(){var n=this;this.imagePicker.getPictures({maximumImagesCount:1,width:800,height:800,quality:80,outputType:0}).then(function(l){for(var t=0;t<l.length;t++)m.a.log("Image URI: "+l[t]),n.fileUrlImage.push(l[t]),n.getImageToBase64(l[t]),n.utils.showLoading("上传中...0%"),n.httpUtils.uploadImageWithPligin(f.a.API+f.a.API_UPLOAD_FILE,l[t],function(l){n.utils.dismissLoading(),n.utils.showNativeToast("图片上传成功! ","long","bottom"),m.a.log("图片上传成功! "+JSON.stringify(l),n.tag)},function(l){n.utils.dismissLoading(),n.utils.showNativeToast("图片上传失败! ","long","bottom"),m.a.error("图片上传失败! "+JSON.stringify(l),n.tag)},function(l){n.utils.setLoadingContent("上传中..."+(l.loaded/l.total*100).toFixed(2)+"%")})},function(l){n.utils.showToastMsg("获取图片失败！Error："+JSON.stringify(l))})},l.prototype.getImageToBase64=function(n){var l=this;m.a.log(n+"图片转换Base64开始",this.tag);var t=document.createElement("CANVAS"),e=t.getContext("2d"),a=new Image;a.crossOrigin="Anonymous",a.onload=function(){t.height=a.height,t.width=a.width,e.drawImage(a,0,0);var i=t.toDataURL("image/png");l.base64Image.push(i),m.a.log(n+"图片转换Base64成功",l.tag)},a.onerror=function(t){m.a.log(n+"图片转换Base64失败："+t&&JSON.stringify(t),l.tag)},a.src=n,(a.complete||void 0===a.complete)&&(a.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a.src=n)},l}(t(791).a),p=function(){return function(){}}(),b=t(397),y=t(398),I=t(399),v=t(400),R=t(401),A=t(402),P=t(403),w=t(404),k=t(405),L=t(408),E=t(34),O=t(29),T=t(3),F=t(65),C=t(124),U=t(123),x=t(7),N=t(407),_=t(44),M=t(13),D=t(28),S=t(406),B=t(85),J=t(59),q=t(195),V=t(35),W=t(6),j=t(14),G=t(38),Q=t(52),$=t(33),H=t(86),K=t(12),Z=t(21),z=t(17),X=t(137),Y=o["ɵcrt"]({encapsulation:2,styles:[],data:{}}),nn=o["ɵccf"]("page-image-pick",h,function(n){return o["ɵvid"](0,[(n()(),o["ɵeld"](0,0,null,null,1,"page-image-pick",[],null,null,null,i,Y)),o["ɵdid"](1,49152,null,0,h,[D.a,z.a,W.a,c.a,g.a,r.a,s.a,d.a,X.a],null,null)],null,null)},{},{},[]),ln=t(31),tn=t(194),en=t(60);t.d(l,"ImagePickModuleNgFactory",function(){return an});var an=o["ɵcmf"](p,[],function(n){return o["ɵmod"]([o["ɵmpd"](512,o.ComponentFactoryResolver,o["ɵCodegenComponentFactoryResolver"],[[8,[b.a,y.a,I.a,v.a,R.a,A.a,P.a,w.a,k.a,nn]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o["ɵmpd"](4608,Z.l,Z.k,[o.LOCALE_ID,[2,Z.t]]),o["ɵmpd"](4608,ln["ɵi"],ln["ɵi"],[]),o["ɵmpd"](4608,ln.FormBuilder,ln.FormBuilder,[]),o["ɵmpd"](512,Z.b,Z.b,[]),o["ɵmpd"](512,ln["ɵba"],ln["ɵba"],[]),o["ɵmpd"](512,ln.FormsModule,ln.FormsModule,[]),o["ɵmpd"](512,ln.ReactiveFormsModule,ln.ReactiveFormsModule,[]),o["ɵmpd"](512,tn.a,tn.a,[]),o["ɵmpd"](512,tn.b,tn.b,[]),o["ɵmpd"](512,p,p,[]),o["ɵmpd"](256,en.a,h,[])])})},791:function(n,l,t){"use strict";t.d(l,"a",function(){return a});var e=t(409),a=function(){function n(n,l,t,e,a){this.navCtrl=n,this.navParams=l,this.platform=t,this.utils=e,this.httpUtils=a}return n.prototype.showWebReqErrLog=function(n){this.utils.showToastMsg(n instanceof e.a?n.message:"网络或服务器问题，请检查网络是否可用！")},n}()}});